(function(b){b(document).ready(function(){b("textarea").autosize();b(document).on("click",".vote_up",function(d){d.preventDefault();var c=b(this).attr("value").split("_");ajaxRating("top",(c.length<2?"post":c[1]),c[0])});b(document).on("click",".vote_down",function(d){d.preventDefault();var c=b(this).attr("value").split("_");ajaxRating("down",(c.length<2?"post":c[1]),c[0])});b(".img__href.img__animated").click(function(d){d.preventDefault();if(!b(this).hasClass("img__play")){var f=b(this).find("img").attr("src");b(this).find("img").attr("src",f.replace(/middle_/g,""));b(this).addClass("img__play");b(this).find(".list__info__img__hint").hide()}else{var c=b(this).attr("value").split(":");b(this).find("img").attr("src","http://yourmood.ru"+c[0]+"/middle_"+c[1]);b(this).removeClass("img__play");b(this).find(".list__info__img__hint").show()}})});b.fn.addComment=function(c){var d={q:"AddComment",id:0};c=b.extend(d,c);if(c.id==0){return}b(this).submit(function(g){g.preventDefault();var e=b(this),h=e.find('textarea[name="text"]').val(),f=e.attr("action");e.find('input[name="button"]').attr("disabled","disabled");b.post(f,{q:c.q,id:c.id,text:h},function(j){b("#message ul").removeClass("error").removeClass("good");b("#message ul").addClass(j.status);var i=/^(good)/i;if(i.test(j.status)){if(b(".getComment h2.navsections").length==0){b(".getComment").append(j.message)}else{b(".getComment").append(j.message)}b(".vote_up").click(function(l){l.preventDefault();var k=b(this).attr("value").split("_");ajaxRating("top",(k.length<2?"post":k[1]),k[0])});b(".vote_down").click(function(l){l.preventDefault();if(confirm("Вы уверены в том, что хотите понизить рейтинг данного поста?")){var k=b(this).attr("value").split("_");ajaxRating("down",(k.length<2?"post":k[1]),k[0])}});e.find('textarea[name="text"]').val("")}else{b("#message").html('<ul class="error">'+j.message+"</ul>")}e.find('input[name="button"]').removeAttr("disabled")},"json")})};b(window).scroll(function(){});var a=true;b(document).ready(function(){b(document).on("focus","input, select, textarea",function(c){a=false});b(document).on("blur","input, select, textarea",function(c){a=true});b(document).keyup(function(d){if(d.which==82&&a){b("body,html").animate({scrollTop:0},0)}})});b.fn.listScroll=function(d){var e={};d=b.extend(e,d);var c=[];b(".item__segment").each(function(g,f){c[g]=[g==0?0:Math.ceil(b(f).offset().top),b(f).height()]});b(document).keyup(function(h){if((87==h.which||83==h.which)&&a){for(var g=b(document).scrollTop(),f=0;f<c.length&&!(c[f][0]+c[f][1]>g+55);f++){}f=83==h.which?++f:--f;0>f&&(f=0);f>=c.length&&(f=c.length-1);b("body,html").animate({scrollTop:c[f][0]-55},100)}})}})($);function deleteItem(a){$("#list-"+a).remove();fieldlist--}function ajaxRating(a,b,c){$.ajax({url:"/svc/Service?q=rating&vote="+a+"&action="+b+"&id="+c+"&lastVote="+$("#vote_"+c).html(),dataType:"json",type:"GET",timeout:5000,cache:false,success:function(e,d){if(d=="success"){$("#vote_"+c).removeClass("vote__error").removeClass("vote__good");$("#vote_"+c).addClass("vote__"+e.status);$("#vote_"+c).fadeOut(0);$("#vote_"+c).fadeIn(200).html(e.message)}},error:function(){$("#vote_"+c).addClass("vote__error");$("#vote_"+c).fadeOut(0);$("#vote_"+c).fadeIn(300).html("Упс!")}})}function log(a,b){b=b!=null?b:"#out__error";$(b).html(a).fadeIn(500);setTimeout(function(){$(b).fadeOut(500)},4000);return false}function confurmSubmit(){var a=$("#addAnekdot").find('input[name="name"]').val();return confirm((a!=""?a+", т":"Т")+"ы удалил с изображений, мусор: логотипы, адреса сайтов, рекламу?\nА категорию указал верно, белеать?")}function randomNumber(a,b){a=parseInt(a);b=parseInt(b);return Math.floor(Math.random()*(b-a+1))+a}function Uploads(e,g){var a=0;var d=new XMLHttpRequest();d.upload.addEventListener("progress",function(f){if(f.lengthComputable){a=Math.round((f.loaded/f.total)*100);if(g.onprogress instanceof Function){g.onprogress(a)}}},false);d.upload.addEventListener("load",function(f){a=100},false);d.upload.addEventListener("error",function(){alert("Error uploading on server")},false);d.onreadystatechange=function(){var f=g.oncomplete instanceof Function;if(this.readyState===4){if(this.status===200){if(f){g.oncomplete(JSON.parse(this.responseText))}}else{log("HTTP response code is not OK ("+this.status+")");if(f){g.oncomplete(false)}}}};d.open("POST",e.url);var c=new FormData();for(var b in e){c.append(b,e[b])}d.send(c)}(function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery||window.$)})(function(d){var b,f={className:"autosizejs",append:"",callback:!1,resizeDelay:10},a='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',g=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],c=d(a).data("autosize",!0)[0];c.style.lineHeight="99px","99px"===d(c).css("lineHeight")&&g.push("lineHeight"),c.style.lineHeight="",d.fn.autosize=function(e){return this.length?(e=d.extend({},f,e||{}),c.parentNode!==document.body&&d(document.body).append(c),this.each(function(){function k(){var h,l;"getComputedStyle" in window?(h=window.getComputedStyle(n,null),l=n.getBoundingClientRect().width,d.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(p,o){l-=parseInt(h[o],10)}),c.style.width=l+"px"):c.style.width=Math.max(j.width(),0)+"px"}function y(){var h={};if(b=n,c.className=e.className,t=parseInt(j.css("maxHeight"),10),d.each(g,function(p,o){h[o]=j.css(o)}),d(c).css(h),k(),window.chrome){var l=n.style.width;n.style.width="0px",n.offsetWidth,n.style.width=l}}function i(){var h,l;b!==n?y():k(),c.value=n.value+e.append,c.style.overflowY=n.style.overflowY,l=parseInt(n.style.height,10),c.scrollTop=0,c.scrollTop=90000,h=c.scrollTop,t&&h>t?(n.style.overflowY="scroll",h=t):(n.style.overflowY="hidden",x>h&&(h=x)),h+=s,l!==h&&(n.style.height=h+"px",A&&e.callback.call(n,n))}function m(){clearTimeout(B),B=setTimeout(function(){var h=j.width();h!==q&&(q=h,i())},parseInt(e.resizeDelay,10))}var t,x,B,n=this,j=d(n),s=0,A=d.isFunction(e.callback),v={height:n.style.height,overflow:n.style.overflow,overflowY:n.style.overflowY,wordWrap:n.style.wordWrap,resize:n.style.resize},q=j.width();j.data("autosize")||(j.data("autosize",!0),("border-box"===j.css("box-sizing")||"border-box"===j.css("-moz-box-sizing")||"border-box"===j.css("-webkit-box-sizing"))&&(s=j.outerHeight()-j.height()),x=Math.max(parseInt(j.css("minHeight"),10)-s||0,j.height()),j.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===j.css("resize")||"vertical"===j.css("resize")?"none":"horizontal"}),"onpropertychange" in n?"oninput" in n?j.on("input.autosize keyup.autosize",i):j.on("propertychange.autosize",function(){"value"===event.propertyName&&i()}):j.on("input.autosize",i),e.resizeDelay!==!1&&d(window).on("resize.autosize",m),j.on("autosize.resize",i),j.on("autosize.resizeIncludeStyle",function(){b=null,i()}),j.on("autosize.destroy",function(){b=null,clearTimeout(B),d(window).off("resize",m),j.off("autosize").off(".autosize").css(v).removeData("autosize")}),i())})):this}});